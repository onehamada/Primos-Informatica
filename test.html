<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Primos Informática</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug { background: #f0f0f0; padding: 10px; margin: 10px 0; }
        .products { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
        .product { border: 1px solid #ddd; padding: 10px; border-radius: 5px; }
        .product img { width: 100%; height: 150px; object-fit: contain; }
        .price { font-weight: bold; color: #10b981; }
        .promocao { color: #ef4444; }
    </style>
</head>
<body>
    <h1>Teste de Carregamento de Produtos</h1>
    <div id="debug" class="debug">Carregando...</div>
    <div id="products" class="products"></div>

    <script>
        const debugEl = document.getElementById('debug');
        const productsEl = document.getElementById('products');
        
        function log(msg) {
            console.log(msg);
            debugEl.innerHTML += '<br>' + msg;
        }

        async function testLoad() {
            try {
                log('Iniciando teste...');
                
                const response = await fetch('data/products.csv');
                log('Status do CSV: ' + response.status);
                
                const text = await response.text();
                log('Tamanho do CSV: ' + text.length + ' caracteres');
                
                const lines = text.split('\n').filter(line => line.trim());
                log('Linhas encontradas: ' + lines.length);
                
                const products = [];
                for (let i = 1; i < Math.min(lines.length, 10); i++) {
                    const parts = lines[i].split(';');
                    if (parts.length >= 8) {
                        products.push({
                            codigo: parts[0],
                            nome: parts[1],
                            categoria: parts[2],
                            preco: parts[3],
                            promocao: parts[7] === 'sim',
                            imagem: parts[8] || ''
                        });
                    }
                }
                
                log('Produtos parseados: ' + products.length);
                
                productsEl.innerHTML = products.map(p => `
                    <div class="product">
                        <img src="images/products/thumbnail/${p.imagem}" onerror="this.src='images/products/thumbnail/default.webp'">
                        <h4>${p.nome}</h4>
                        <div class="price ${p.promocao ? 'promocao' : ''}">R$ ${p.preco}</div>
                        <small>${p.categoria} ${p.promocao ? '(PROMOÇÃO)' : ''}</small>
                    </div>
                `).join('');
                
                log('Teste concluído com sucesso!');
                
            } catch (error) {
                log('ERRO: ' + error.message);
                console.error(error);
            }
        }

        testLoad();
    </script>
</body>
</html>
